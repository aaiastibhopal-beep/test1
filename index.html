<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8">
Â  <title>Certificate Verification</title>
Â  <style>
Â  Â  body { font-family:sans-serif; margin-top:40px; background:#f6f6f6;}
Â  Â  .container { background: #fff; padding:25px; box-shadow:0 2px 10px #dadada; border-radius:8px; max-width:400px; margin:auto;}
Â  Â  table { margin-top:16px; width:100%; border-collapse:collapse;}
Â  Â  h2{color:green;}
Â  Â  .fail{color:red;}
Â  Â  td {vertical-align: top; padding:4px 8px;}
Â  Â  tr:nth-child(odd){background:#f9f9f9;}
Â  </style>
</head>
<body>
<div class="container">Â 
<h2>Certificate Verificationâœ”ï¸</h2>
Â  <input type="text" id="certId" placeholder="Enter Serial No." /> Â  <button onclick="verify()">Verify</button> Â 
<div id="result"></div>
</div>
<p>
<script>
// The Sheet URL is confirmed to be in the correct CSV format.
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR4V9M26cq8UzG76m0WLm8Y49Wpd8uA-yl6TpUGCesZAS-NQZbpy4nt8GmElDuqs0M44b8BVzPAC5YG/pub?gid=0&single=true&output=csv";

let csvData = {};

function fetchSheet(callback) {
Â  fetch(SHEET_URL)
Â  Â  .then(response => {
        if (!response.ok) {
            // This is the place where the "Failed to fetch" error is caught, usually due to CORS/security policy.
            throw new Error('Sheet Access Error: Network response not ok, or sheet is not publicly published.');
        }
        return response.text();
    })
Â  Â  .then(text => {
Â  Â  Â  let lines = text.trim().split('\n');
      if (lines.length < 2) {
          throw new Error('Sheet Data Error: The sheet is empty or contains only headers.');
      }
Â  Â  Â  let headers = lines[0].replace(/\r/g,'').split(',').map(h => h.trim());
Â  Â  Â  let data = {};
Â  Â  Â  
Â  Â  Â  for (let i = 1; i < lines.length; i++) {
Â  Â  Â  Â  let row = lines[i].replace(/\r/g,'').split(',').map(x => x.trim());
Â  Â  Â  Â  let obj = {};
Â  Â  Â  Â  for (let j = 0; j < headers.length; j++) {
Â  Â  Â  Â  Â  obj[headers[j]] = row[j] || ""; 
Â  Â  Â  Â  }
        if(obj["Serial No."]) { 
Â  Â  Â  Â     data[obj["Serial No."]] = obj;
        }
Â  Â  Â  }
Â  Â  Â  csvData = data;
Â  Â  Â  if(callback) callback();
Â  Â  })
    .catch(error => {
        console.error('Data loading error:', error);
        document.getElementById('result').innerHTML = "<h2 class='fail'>âŒ Data Loading Failed! Please host this file online (e.g., GitHub Pages) or check sheet publishing settings.</h2>";
    });
}

function verify() {
Â  let id = document.getElementById('certId').value.trim();
Â  let resultDiv = document.getElementById('result');

Â  if (!id) {
    resultDiv.innerHTML = "<h2 class='fail'>Please enter a Serial No.</h2>";
    return;
  }
  
Â  if (Object.keys(csvData).length === 0) {
Â  Â  resultDiv.innerHTML = "<h3>â³ Fetching data... Please wait.</h3>"; 
Â  Â  fetchSheet(() => verify()); 
Â  Â  return;
Â  }
  
Â  let data = csvData[id];
Â  if(data && data["Serial No."]){
Â  Â  resultDiv.innerHTML =
Â  Â  Â  `<h2>âœ”ï¸ğŸ˜ Certificate Verified!</h2>
Â  Â  Â  Â <table>
Â  Â  Â  Â  <tr><td><b>Institute</b></td><td>${data["Institute"]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Course Name</b></td><td>${data["Course Name"]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Serial No.</b></td><td>${data["Serial No."]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Name</b></td><td>${data["Name"]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Designation</b></td><td>${data["Designation"]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Date of Validity</b></td><td>${data["Date of Validity"]}</td></tr>
Â  Â  Â  Â  <tr><td><b>Status</b></td><td>${data["Status"]}</td></tr>
Â  Â  Â  Â </table>`;
Â  }else{
Â  Â  resultDiv.innerHTML = "<h2 class='fail'>âŒâ˜ ï¸ Certificate NOT found!</h2>";
Â  }
}

window.onload = function() {
Â  fetchSheet(()=>{Â 
Â  Â  let params = new URLSearchParams(window.location.search);
Â  Â  let autoCert = params.get("cert");
Â  Â  if(autoCert){
Â  Â  Â  document.getElementById('certId').value = autoCert;
Â  Â  Â  verify();
Â  Â  }
Â  });
};
</script>
</p>
</body>
</html>